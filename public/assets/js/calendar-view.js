(()=>{document.addEventListener("DOMContentLoaded",function(){let M=document.querySelectorAll(".view-btn"),D=document.querySelector(".events-calendar-view"),g=document.querySelector(".events-list-view");if(!D||!g)return;let y=new Date,w=null;function q(){let t=document.querySelectorAll(".event-card"),e=new Date;t.forEach(o=>{new Date(o.dataset.eventDate)<e&&o.classList.add("past-event")}),document.querySelectorAll(".event-card-date-badge").forEach(o=>{let s=o.dataset.date;if(s&&!o.querySelector(".event-day").textContent){let l=new Date(s),p=l.getDate(),u=l.toLocaleDateString("en-US",{month:"short"});o.querySelector(".event-day").textContent=p,o.querySelector(".event-month").textContent=u}})}q(),document.body.addEventListener("click",function(t){t.target.matches(".event-show-more")&&(document.querySelectorAll(".event-card.hidden-event").forEach(c=>{c.classList.remove("hidden-event")}),t.target.style.display="none")}),M.forEach(t=>{t.addEventListener("click",function(){let e=this.dataset.view;M.forEach(c=>c.classList.remove("active")),this.classList.add("active"),e==="calendar"?(D.classList.add("active-view"),g.classList.remove("active-view")):(D.classList.remove("active-view"),g.classList.add("active-view"))})});function H(){let t=document.querySelectorAll(".event-data-item");return Array.from(t).map(e=>({title:e.dataset.title,date:new Date(e.dataset.date),location:e.dataset.location,details:e.dataset.details}))}let x=document.querySelector(".prev-month"),b=document.querySelector(".next-month");x&&x.addEventListener("click",()=>{y.setMonth(y.getMonth()-1),f()}),b&&b.addEventListener("click",()=>{y.setMonth(y.getMonth()+1),f()});function f(){let t=document.querySelector(".calendar-month-year"),e=document.querySelector(".calendar-grid");if(!t||!e)return;let c=H(),o=y.getFullYear(),s=y.getMonth(),l=["January","February","March","April","May","June","July","August","September","October","November","December"];t.textContent=`${l[s]} ${o}`,e.innerHTML="",["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(a=>{let n=document.createElement("div");n.className="calendar-day-header",n.textContent=a,e.appendChild(n)});let u=new Date(o,s,1).getDay(),E=new Date(o,s+1,0).getDate();for(let a=0;a<u;a++){let n=document.createElement("div");n.className="calendar-day empty",e.appendChild(n)}for(let a=1;a<=E;a++){let n=document.createElement("div");n.className="calendar-day";let r=new Date(o,s,a),i=c.filter(C=>C.date.toDateString()===r.toDateString()),v=document.createElement("div");if(v.className="calendar-day-number",v.textContent=a,n.appendChild(v),i.length>0){n.classList.add("has-event");let C=document.createElement("div");C.className="calendar-day-events",i.forEach(k=>{let L=document.createElement("div");L.className="event-chip";let S=document.createElement("span");S.className="event-chip-time",S.textContent=T(k.date);let N=document.createElement("span");N.className="event-chip-title",N.textContent=k.title,L.appendChild(S),L.appendChild(N),C.appendChild(L)}),n.appendChild(C)}let h=new Date;h.setHours(0,0,0,0);let d=new Date(r);d.setHours(0,0,0,0),d.toDateString()===h.toDateString()&&n.classList.add("today"),d<h&&n.classList.add("past-day"),w&&r.toDateString()===w.toDateString()&&n.classList.add("selected"),n.addEventListener("click",()=>{i.length>0&&(w=r,f(),B(r,i))}),e.appendChild(n)}}function B(t,e){let c=document.getElementById("calendarModal");if(!c)return;let o={weekday:"long",year:"numeric",month:"long",day:"numeric"},s=t.toLocaleDateString("en-US",o),l=c.querySelector(".calendar-modal-body");if(!l)return;l.innerHTML="";let p=document.createElement("h2");p.className="modal-date-header",p.textContent=s,l.appendChild(p);let u=document.createElement("p");u.className="modal-event-count",u.textContent=`${e.length} Event${e.length>1?"s":""}`,l.appendChild(u);let E=document.createElement("div");E.className="modal-events-container",e.forEach((a,n)=>{let r=document.createElement("div");r.className="modal-event-card";let i=document.createElement("div"),v=document.createElement("p");v.className="modal-event-title",v.textContent=a.title,i.appendChild(v);let h=document.createElement("p");if(h.className="modal-event-time",h.innerHTML=`<strong>Time:</strong> ${T(a.date)}`,i.appendChild(h),a.location){let d=document.createElement("p");d.className="modal-event-location",d.innerHTML=`<strong>Location:</strong> ${a.location}`,i.appendChild(d)}if(r.appendChild(i),a.details){let d=document.createElement("div");d.className="modal-event-details",d.innerHTML=a.details,r.appendChild(d)}E.appendChild(r)}),l.appendChild(E),c.classList.add("active"),document.body.style.overflow="hidden"}let m=document.getElementById("calendarModal");if(m){let t=m.querySelector(".calendar-modal-close"),e=m.querySelector(".calendar-modal-overlay");t&&t.addEventListener("click",()=>{m.classList.remove("active"),document.body.style.overflow=""}),e&&e.addEventListener("click",()=>{m.classList.remove("active"),document.body.style.overflow=""}),document.addEventListener("keydown",c=>{c.key==="Escape"&&m.classList.contains("active")&&(m.classList.remove("active"),document.body.style.overflow="")})}function T(t){return t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}f(),window.addEventListener("calendarDataLoaded",function(){q(),f()})});})();
