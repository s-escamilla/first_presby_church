(()=>{document.addEventListener("DOMContentLoaded",function(){let M=document.querySelectorAll(".view-btn"),L=document.querySelector(".events-calendar-view"),D=document.querySelector(".events-list-view");if(!L||!D)return;let y=new Date,g=null;function q(){let n=document.querySelectorAll(".event-card"),e=new Date;n.forEach(o=>{new Date(o.dataset.eventDate)<e&&o.classList.add("past-event")}),document.querySelectorAll(".event-card-date-badge").forEach(o=>{let a=o.dataset.date;if(a&&!o.querySelector(".event-day").textContent){let i=new Date(a),p=i.getDate(),v=i.toLocaleDateString("en-US",{month:"short"});o.querySelector(".event-day").textContent=p,o.querySelector(".event-month").textContent=v}})}q(),document.body.addEventListener("click",function(n){n.target.matches(".event-show-more")&&(document.querySelectorAll(".event-card.hidden-event").forEach(c=>{c.classList.remove("hidden-event")}),n.target.style.display="none")}),M.forEach(n=>{n.addEventListener("click",function(){let e=this.dataset.view;M.forEach(c=>c.classList.remove("active")),this.classList.add("active"),e==="calendar"?(L.classList.add("active-view"),D.classList.remove("active-view")):(L.classList.remove("active-view"),D.classList.add("active-view"))})});function H(){let n=document.querySelectorAll(".event-data-item");return Array.from(n).map(e=>({title:e.dataset.title,date:new Date(e.dataset.date),location:e.dataset.location,details:e.dataset.details}))}let x=document.querySelector(".prev-month"),b=document.querySelector(".next-month");x&&x.addEventListener("click",()=>{y.setMonth(y.getMonth()-1),f()}),b&&b.addEventListener("click",()=>{y.setMonth(y.getMonth()+1),f()});function f(){let n=document.querySelector(".calendar-month-year"),e=document.querySelector(".calendar-grid");if(!n||!e)return;let c=H(),o=y.getFullYear(),a=y.getMonth(),i=["January","February","March","April","May","June","July","August","September","October","November","December"];n.textContent=`${i[a]} ${o}`,e.innerHTML="",["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(s=>{let t=document.createElement("div");t.className="calendar-day-header",t.textContent=s,e.appendChild(t)});let v=new Date(o,a,1).getDay(),r=new Date(o,a+1,0).getDate();for(let s=0;s<v;s++){let t=document.createElement("div");t.className="calendar-day empty",e.appendChild(t)}for(let s=1;s<=r;s++){let t=document.createElement("div");t.className="calendar-day";let l=new Date(o,a,s),m=c.filter(E=>E.date.toDateString()===l.toDateString()),h=document.createElement("div");if(h.className="calendar-day-number",h.textContent=s,t.appendChild(h),m.length>0){t.classList.add("has-event");let E=document.createElement("div");E.className="calendar-day-events",m.forEach(k=>{let C=document.createElement("div");C.className="event-chip";let S=document.createElement("span");S.className="event-chip-time",S.textContent=T(k.date);let N=document.createElement("span");N.className="event-chip-title",N.textContent=k.title,C.appendChild(S),C.appendChild(N),E.appendChild(C)}),t.appendChild(E)}let d=new Date;d.setHours(0,0,0,0);let w=new Date(l);w.setHours(0,0,0,0),w.toDateString()===d.toDateString()&&t.classList.add("today"),w<d&&t.classList.add("past-day"),g&&l.toDateString()===g.toDateString()&&t.classList.add("selected"),t.addEventListener("click",()=>{m.length>0&&(g=l,f(),B(l,m))}),e.appendChild(t)}}function B(n,e){let c=document.getElementById("calendarModal");if(!c)return;let o={weekday:"long",year:"numeric",month:"long",day:"numeric"},a=c.querySelector(".calendar-modal-body");if(!a)return;a.innerHTML="";let i=document.createElement("h2");i.className="modal-date-header",i.textContent=n,a.appendChild(i);let p=document.createElement("p");p.className="modal-event-count",p.textContent=`${e.length} Event${e.length>1?"s":""}`,a.appendChild(p);let v=document.createElement("div");v.className="modal-events-container",e.forEach((r,s)=>{let t=document.createElement("div");t.className="modal-event-card";let l=document.createElement("div"),m=document.createElement("p");m.className="modal-event-title",m.textContent=r.title,l.appendChild(m);let h=document.createElement("p");if(h.className="modal-event-time",h.innerHTML=`<strong>Time:</strong> ${T(r.date)}`,l.appendChild(h),r.location){let d=document.createElement("p");d.className="modal-event-location",d.innerHTML=`<strong>Location:</strong> ${r.location}`,l.appendChild(d)}if(t.appendChild(l),r.details){let d=document.createElement("div");d.className="modal-event-details",d.innerHTML=r.details,t.appendChild(d)}v.appendChild(t)}),a.appendChild(v),c.classList.add("active"),document.body.style.overflow="hidden"}let u=document.getElementById("calendarModal");if(u){let n=u.querySelector(".calendar-modal-close"),e=u.querySelector(".calendar-modal-overlay");n&&n.addEventListener("click",()=>{u.classList.remove("active"),document.body.style.overflow=""}),e&&e.addEventListener("click",()=>{u.classList.remove("active"),document.body.style.overflow=""}),document.addEventListener("keydown",c=>{c.key==="Escape"&&u.classList.contains("active")&&(u.classList.remove("active"),document.body.style.overflow="")})}function T(n){return n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}f(),window.addEventListener("calendarDataLoaded",function(){q(),f()})});})();
