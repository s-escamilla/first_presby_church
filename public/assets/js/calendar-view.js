(()=>{document.addEventListener("DOMContentLoaded",function(){let M=document.querySelectorAll(".view-btn"),D=document.querySelector(".events-calendar-view"),w=document.querySelector(".events-list-view");if(!D||!w)return;let f=new Date,S=null;function q(){let a=document.querySelectorAll(".event-card"),e=new Date;a.forEach(o=>{new Date(o.dataset.eventDate)<e&&o.classList.add("past-event")}),document.querySelectorAll(".event-card-date-badge").forEach(o=>{let c=o.dataset.date;if(c&&!o.querySelector(".event-day").textContent){let u=new Date(c),v=u.getDate(),h=u.toLocaleDateString("en-US",{month:"short"});o.querySelector(".event-day").textContent=v,o.querySelector(".event-month").textContent=h}});let r=document.querySelector(".event-show-more");r&&r.addEventListener("click",function(){document.querySelectorAll(".event-card.hidden-event").forEach(c=>{c.classList.remove("hidden-event")}),this.style.display="none"})}q(),M.forEach(a=>{a.addEventListener("click",function(){let e=this.dataset.view;M.forEach(s=>s.classList.remove("active")),this.classList.add("active"),e==="calendar"?(D.classList.add("active-view"),w.classList.remove("active-view")):(D.classList.remove("active-view"),w.classList.add("active-view"))})});function B(){let a=document.querySelectorAll(".event-data-item");return Array.from(a).map(e=>({title:e.dataset.title,date:new Date(e.dataset.date),location:e.dataset.location,details:e.dataset.details}))}let x=document.querySelector(".prev-month"),T=document.querySelector(".next-month");x&&x.addEventListener("click",()=>{f.setMonth(f.getMonth()-1),E()}),T&&T.addEventListener("click",()=>{f.setMonth(f.getMonth()+1),E()});function E(){let a=document.querySelector(".calendar-month-year"),e=document.querySelector(".calendar-grid");if(!a||!e)return;let s=B(),r=f.getFullYear(),o=f.getMonth(),c=["January","February","March","April","May","June","July","August","September","October","November","December"];a.textContent=`${c[o]} ${r}`,e.innerHTML="",["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(n=>{let t=document.createElement("div");t.className="calendar-day-header",t.textContent=n,e.appendChild(t)});let v=new Date(r,o,1).getDay(),h=new Date(r,o+1,0).getDate();for(let n=0;n<v;n++){let t=document.createElement("div");t.className="calendar-day empty",e.appendChild(t)}for(let n=1;n<=h;n++){let t=document.createElement("div");t.className="calendar-day";let l=new Date(r,o,n),i=s.filter(C=>C.date.toDateString()===l.toDateString()),y=document.createElement("div");if(y.className="calendar-day-number",y.textContent=n,t.appendChild(y),i.length>0){t.classList.add("has-event");let C=document.createElement("div");C.className="calendar-day-events",i.forEach(k=>{let L=document.createElement("div");L.className="event-chip";let g=document.createElement("span");g.className="event-chip-time",g.textContent=b(k.date);let N=document.createElement("span");N.className="event-chip-title",N.textContent=k.title,L.appendChild(g),L.appendChild(N),C.appendChild(L)}),t.appendChild(C)}let p=new Date;p.setHours(0,0,0,0);let d=new Date(l);d.setHours(0,0,0,0),d.toDateString()===p.toDateString()&&t.classList.add("today"),d<p&&t.classList.add("past-day"),S&&l.toDateString()===S.toDateString()&&t.classList.add("selected"),t.addEventListener("click",()=>{i.length>0&&(S=l,E(),H(l,i))}),e.appendChild(t)}}function H(a,e){let s=document.getElementById("calendarModal");if(!s)return;let r={weekday:"long",year:"numeric",month:"long",day:"numeric"},o=a.toLocaleDateString("en-US",r),c=s.querySelector(".calendar-modal-body");if(!c)return;c.innerHTML="";let u=document.createElement("h2");u.className="modal-date-header",u.textContent=o,c.appendChild(u);let v=document.createElement("p");v.className="modal-event-count",v.textContent=`${e.length} Event${e.length>1?"s":""}`,c.appendChild(v);let h=document.createElement("div");h.className="modal-events-container",e.forEach((n,t)=>{let l=document.createElement("div");l.className="modal-event-card";let i=document.createElement("span"),y=document.createElement("p");y.className="modal-event-title",y.textContent=n.title,i.appendChild(y);let p=document.createElement("p");if(p.className="modal-event-time",p.innerHTML=`<strong>Time:</strong> ${b(n.date)}`,i.appendChild(p),n.location){let d=document.createElement("p");d.className="modal-event-location",d.innerHTML=`<strong>Location:</strong> ${n.location}`,i.appendChild(d)}if(l.appendChild(i),n.details){let d=document.createElement("div");d.className="modal-event-details",d.innerHTML=n.details,l.appendChild(d)}h.appendChild(l)}),c.appendChild(h),s.classList.add("active"),document.body.style.overflow="hidden"}let m=document.getElementById("calendarModal");if(m){let a=m.querySelector(".calendar-modal-close"),e=m.querySelector(".calendar-modal-overlay");a&&a.addEventListener("click",()=>{m.classList.remove("active"),document.body.style.overflow=""}),e&&e.addEventListener("click",()=>{m.classList.remove("active"),document.body.style.overflow=""}),document.addEventListener("keydown",s=>{s.key==="Escape"&&m.classList.contains("active")&&(m.classList.remove("active"),document.body.style.overflow="")})}function b(a){return a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}E(),window.addEventListener("calendarDataLoaded",function(){q(),E()})});})();
