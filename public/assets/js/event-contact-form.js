(()=>{var y=(a,u,r)=>new Promise((c,d)=>{var e=n=>{try{s(r.next(n))}catch(i){d(i)}},t=n=>{try{s(r.throw(n))}catch(i){d(i)}},s=n=>n.done?c(n.value):Promise.resolve(n.value).then(e,t);s((r=r.apply(a,u)).next())});document.addEventListener("DOMContentLoaded",function(){let a=document.getElementById("eventContactForm");if(!a)return;let u=document.getElementById("phone");u&&u.addEventListener("input",function(e){let t=e.target.value.replace(/\D/g,"");t.length>0&&(t.length<=3?t=`(${t}`:t.length<=6?t=`(${t.slice(0,3)}) ${t.slice(3)}`:t=`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`),e.target.value=t});let r=document.getElementById("eventDate");if(r){let e=new Date().toISOString().split("T")[0];r.setAttribute("min",e)}function c(e){let t=document.getElementById(`${e.id}Error`),s=!0,n="";if(t&&(t.textContent=""),e.classList.remove("invalid"),e.hasAttribute("required")&&!e.value.trim()&&(s=!1,n="This field is required"),e.type==="email"&&e.value.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)||(s=!1,n="Please enter a valid email address")),e.id==="phone"&&e.value.trim()&&e.value.replace(/\D/g,"").length!==10&&(s=!1,n="Please enter a valid 10-digit phone number"),e.type==="date"&&e.value){let i=new Date(e.value),l=new Date;l.setHours(0,0,0,0),i<l&&(s=!1,n="Event date must be in the future")}return!s&&t&&(t.textContent=n,e.classList.add("invalid")),s}let d=a.querySelectorAll("input, select, textarea");d.forEach(e=>{e.addEventListener("blur",function(){c(this)}),e.addEventListener("input",function(){this.classList.contains("invalid")&&c(this)})}),a.addEventListener("submit",function(e){return y(this,null,function*(){e.preventDefault();let t=!0;if(d.forEach(o=>{c(o)||(t=!1)}),!t){let o=a.querySelector(".invalid");o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),o.focus());return}let s=a.querySelector(".submit-btn"),n=s.querySelector(".btn-text"),i=s.querySelector(".btn-loader"),l=document.getElementById("successMessage"),m=document.getElementById("errorMessage");s.disabled=!0,n.style.display="none",i.style.display="inline-flex",l.style.display="none",m.style.display="none";let v={name:document.getElementById("name").value.trim(),phone:document.getElementById("phone").value.trim(),email:document.getElementById("email").value.trim(),eventType:document.getElementById("eventType").value,eventDate:document.getElementById("eventDate").value,eventDescription:document.getElementById("eventDescription").value.trim(),submittedAt:new Date().toISOString()};try{if(window.location.hostname!=="localhost"&&window.location.hostname!==""){let g=a.dataset.apiEndpoint||"http://167.172.22.76/api/database/index.php"}else{let g=a.dataset.apiEndpoint||"/api/database/index.php"}let o=yield fetch(apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({functionname:"create",collection:"eventRequests",arguments:v})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let p=yield o.json();l.style.display="flex",a.reset(),l.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{l.style.display="none"},1e4)}catch(o){console.error("Form submission error:",o);let p=document.getElementById("errorMessageText");p.textContent="Sorry, there was an error submitting your request. Please try again or contact us directly.",m.style.display="flex",m.scrollIntoView({behavior:"smooth",block:"center"})}finally{s.disabled=!1,n.style.display="inline",i.style.display="none"}})})});})();
