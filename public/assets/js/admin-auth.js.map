{
  "version": 3,
  "sources": ["../../../src/assets/js/admin-auth.js"],
  "sourcesContent": ["/**\n * Admin Authentication Utility\n * Shared authentication functions for all admin pages\n */\n\nconst AdminAuth = (function() {\n    'use strict';\n\n    // Configuration\n    const CONFIG = {\n        sessionKey: 'adminSession',\n        loginPath: '/admin/login/',\n        dashboardPath: '/admin/dashboard/'\n    };\n\n    /**\n     * Get current session from localStorage\n     * @returns {Object|null} Session object or null if not found\n     */\n    function getSession() {\n        try {\n            const sessionData = localStorage.getItem(CONFIG.sessionKey);\n            if (!sessionData) return null;\n            \n            const session = JSON.parse(sessionData);\n            \n            // Check if session has expired\n            if (session.expiresAt && session.expiresAt < Date.now()) {\n                clearSession();\n                return null;\n            }\n            \n            return session;\n        } catch (e) {\n            console.error('Error reading session:', e);\n            return null;\n        }\n    }\n\n    /**\n     * Check if user is authenticated\n     * @returns {boolean} True if user has valid session\n     */\n    function isAuthenticated() {\n        const session = getSession();\n        return session !== null && session.expiresAt > Date.now();\n    }\n\n    /**\n     * Get current user information\n     * @returns {Object|null} User object or null\n     */\n    function getCurrentUser() {\n        const session = getSession();\n        if (!session) return null;\n        \n        return {\n            username: session.username,\n            name: session.name,\n            loginTime: session.loginTime,\n            expiresAt: session.expiresAt\n        };\n    }\n\n    /**\n     * Clear session and logout\n     */\n    function clearSession() {\n        localStorage.removeItem(CONFIG.sessionKey);\n    }\n\n    /**\n     * Logout user and redirect to login page\n     * @param {string} redirectTo - Optional redirect path after logout\n     */\n    function logout(redirectTo = null) {\n        clearSession();\n        \n        const loginUrl = new URL(CONFIG.loginPath, window.location.origin);\n        if (redirectTo) {\n            loginUrl.searchParams.set('redirect', redirectTo);\n        }\n        \n        window.location.href = loginUrl.toString();\n    }\n\n    /**\n     * Require authentication - redirect to login if not authenticated\n     * Call this function at the top of protected pages\n     * @param {string} currentPath - Current page path for redirect after login\n     */\n    function requireAuth(currentPath = null) {\n        if (!isAuthenticated()) {\n            const path = currentPath || window.location.pathname;\n            const loginUrl = new URL(CONFIG.loginPath, window.location.origin);\n            loginUrl.searchParams.set('redirect', path);\n            window.location.href = loginUrl.toString();\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Update session activity (extend expiration)\n     */\n    function updateActivity() {\n        const session = getSession();\n        if (!session) return;\n        \n        // Extend session if remember me was checked\n        if (session.rememberMe) {\n            const duration = 24 * 60 * 60 * 1000; // 24 hours\n            session.expiresAt = Date.now() + duration;\n            localStorage.setItem(CONFIG.sessionKey, JSON.stringify(session));\n        }\n    }\n\n    /**\n     * Format session time remaining\n     * @returns {string} Human-readable time remaining\n     */\n    function getTimeRemaining() {\n        const session = getSession();\n        if (!session) return 'Not logged in';\n        \n        const remaining = session.expiresAt - Date.now();\n        if (remaining < 0) return 'Expired';\n        \n        const hours = Math.floor(remaining / (1000 * 60 * 60));\n        const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));\n        \n        if (hours > 0) {\n            return `${hours}h ${minutes}m`;\n        }\n        return `${minutes}m`;\n    }\n\n    /**\n     * Initialize authentication for a page\n     * Sets up activity tracking and session monitoring\n     */\n    function init() {\n        // Update activity on user interaction\n        const events = ['mousedown', 'keydown', 'scroll', 'touchstart'];\n        events.forEach(event => {\n            document.addEventListener(event, () => {\n                updateActivity();\n            }, { passive: true, once: false });\n        });\n\n        // Check session every minute\n        setInterval(() => {\n            if (!isAuthenticated()) {\n                alert('Your session has expired. Please login again.');\n                logout();\n            }\n        }, 60000);\n    }\n\n    // Public API\n    return {\n        getSession,\n        isAuthenticated,\n        getCurrentUser,\n        logout,\n        requireAuth,\n        getTimeRemaining,\n        init,\n        clearSession\n    };\n})();\n\n// Auto-initialize if script is loaded\nif (typeof window !== 'undefined') {\n    window.AdminAuth = AdminAuth;\n}\n"],
  "mappings": "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",
  "names": []
}
